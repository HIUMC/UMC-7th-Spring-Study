# 도메인 분석 설계

# 도메인 모델과 테이블 설계

---

![image.png](%E1%84%83%E1%85%A9%E1%84%86%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%20%E1%84%87%E1%85%AE%E1%86%AB%E1%84%89%E1%85%A5%E1%86%A8%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%80%E1%85%A8%2013fd916bc5a880cdb24ac6fc587cb9af/image.png)

![image.png](%E1%84%83%E1%85%A9%E1%84%86%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%20%E1%84%87%E1%85%AE%E1%86%AB%E1%84%89%E1%85%A5%E1%86%A8%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%80%E1%85%A8%2013fd916bc5a880cdb24ac6fc587cb9af/image%201.png)

- 단방향 : 한 쪽에서만 참조하는 경우. (한 쪽은 상대에 대한 어떠한 정보도 없다.)
- 양방향 : 양쪽에서 참조할 수 있음. 단순 조회 포함.

- Member에 주문리스트(양방향)는 사실 필요가 없다. 실무에서는 회원이 주문을 참조하지 않고, 주문이 회원을 참조하는 것으로 충분하다. (**단방향 권장**)
    - 영한: “회원을 통해서 주문이 일어난다가 아니라, 주문을 생성할 때 회원이 필요하다고 보는게 더 맞다”
    - “쿼리로도, 주문 내역이 필요하면 멤버를 찾아서 거기 있는 리스트로 오더를 찾아오는 게 아니라, 그냥 오더에서 필터링 조건에 멤버가 들어가게 될 뿐”
- 테이블 명이 ORDERS인 것은 데이터베이스가 order by 때문에 예약어로 잡고 있는 경우가 많다. 그래서 관례상 ORDERS를 많이 사용한다.

# 연관관계의 주인

---

## **외래키가 가까운 곳에 있는 것을 연관관계의 주인으로 잡자.**

---

- 연관관계의 주인 쪽에 값 세팅을 해야 값이 변경된다.
    - **1:N**
        - N쪽이 연관관계의 주인, 외래키를 가진다.
            - 값 세팅
        - 1쪽은 mapped_by, 연관관계의 거울이 된다.
            - 단순하게 조회만
    - **1:1**
        - 연관관계의 주인: 어느쪽이든 상관없음. 다만 한쪽을 정했으면 다른쪽은 연관관계의 거울.
        - 하지만 강조되는 **대원칙**
            - : **외래키가 가까운 곳에 있는 것을 연관관계의 주인으로 잡자.**

- `mapped_by = "member"` 은 member가 연관관계의 거울이란 뜻.
    - 정확히는, N쪽에 있는 `member` 라는 이름의 객체가 연관관계의 주인

## 양방향인 경우 연관관계 편의 메서드를 작성한다.

---

*자세한 것은 JPA 기본편을 참고*

영한 왈:

- 양쪽에 값을 세팅해주는 것이 목적.
- 양방향이니까 객체적으로 왔다갔다 할 수 있게

![image.png](%E1%84%83%E1%85%A9%E1%84%86%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%20%E1%84%87%E1%85%AE%E1%86%AB%E1%84%89%E1%85%A5%E1%86%A8%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%80%E1%85%A8%2013fd916bc5a880cdb24ac6fc587cb9af/image%202.png)

![image.png](%E1%84%83%E1%85%A9%E1%84%86%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%20%E1%84%87%E1%85%AE%E1%86%AB%E1%84%89%E1%85%A5%E1%86%A8%20%E1%84%89%E1%85%A5%E1%86%AF%E1%84%80%E1%85%A8%2013fd916bc5a880cdb24ac6fc587cb9af/image%203.png)